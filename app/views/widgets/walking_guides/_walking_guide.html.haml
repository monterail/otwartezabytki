%h1
  = t('widget.walking_guide.title')
  %span(ng-show="loading")= "#{t('widget.walking_guide.loading')}..."
  %a.back(href=widgets_path)= t('views.widgets.edit.back')
.walking-guide__content
  .walking-guide__sidebar
    %h2(ng-show="widget.relics.length") Relics
    %ul.walking-guide__relics(ui-sortable="sortableOptions" ng-model="widget.relics" ng-if="widget.relics.length")
      %li.walking-guide__relic(ng-repeat="relic in widget.relics")
        %h3.walking-guide-relic__title {{ relic.identification }}
        %p.walking-guide-relic__location
          %span(ng-show="relic.street") {{ relic.street }},
          {{ relic.place }}
        %button.walkig-guide-relic__remove(type="button" ng-click="removeRelic(relic)") &times;
    .walking-guide__search
      %form(name="searchForm" ng-submit="searchRelics()")
        %input.walking-guide-search__query(type="text" name="query" ng-minlength="4" ng-model="query" placeholder="what, where")
        %button.walkig-guide-relic__remove(type="button" ng-click="resetForm()" ng-show="query") &times;
        %span.error(ng-show="searchForm.submitted && searchForm.query.$error.minlength")
          Query is too short!
        %input.hidden(type="submit")
        %span(ng-show="suggestions && !suggestions.length")
          Nothing found
        .clearfix
    .walking-guide__suggestions(ng-if="suggestions")
      %ul.walking-guide-suggestions__container
        %li.walking-guide__suggestion(ng-repeat="relic in filteredSuggestions()")
          %a(ng-click="selectRelic(relic)" href="")
            %h3.walking-guide-suggestion__title {{ relic.identification }}
            %p.walking-guide-suggestion__location
              %span(ng-show="relic.street") {{ relic.street }},
              {{ relic.place }}
      %button.button.button--load-more(type="button" ng-click="nextPage()" ng-show="currentPage + 1 < totalPages" ng-disabled="loading")
        {{ loading && 'Loading...' || 'Load more' }}
    .walking-guide__description
      %h2 Description
      %textarea(ng-model="widget.description")
    %button.button.button--save(type="button" ng-click="save()" ng-disabled="saving || loading")
      {{ saving && 'Saving...' || 'Save' }}
  %div(google-map="true" center="map.center" zoom="map.zoom" events="map.events")
