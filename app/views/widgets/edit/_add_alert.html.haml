%h1
  #{widget.class.title}
  %a.back{:href => widgets_path} &laquo; wróć do katalogu widżetów
.sidebar
  = semantic_form_for widget_add_alert, :url => self.send("widgets_#{widget.class.partial_name}_path", widget) do |f|
    = f.input :q, :label => false, :hint => "Wyszukaj zabytek"
    = f.submit "Szukaj", :class => "use-widget"
    = f.input :relic_id, :as => :hidden, :label => false
    - if searched_relics.present?
      %h3 O który zabytek dokładnie Ci chodziło
      .relics-wrapper
        %ul.relics
          - searched_relics.each do |relic|
            %li
              = link_to t('views.relicbuilders.new.choose_html'), 'javascript: void(0);', 'data-relic_id' => relic.id, 'data-identification' => relic.identification
              %strong= relic.identification
.content
  - if widget.valid?
    %h2 Podgląd wygenerowanego widżetu
    .preview
      = raw(widget.snippet)
    %h2 Wygenerowany kod do wstawienia na stronę
    %div
      %span.block To jest gotowy kod do wstawienia na stronę, wygenerowany dla wybranego przez Ciebie zabytku. Wystarczy go skopiować i umieścić w odpowiednim miejscu na Twojej stronie.
      %textarea{:cols => "20", :rows => "3"}= widget.snippet

- content_for(:footer_javascripts) do
  :coffeescript
    jQuery("a[data-relic_id]").click (e) ->
      $('#widget_add_alert_relic_id').val $(this).data('relic_id')
      $(this).parents('form').submit()
